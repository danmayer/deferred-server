require 'json'
require 'fog'
require 'rest-client'
require 'digest/md5'
require './lib/server-commands'
require './lib/server-files'
include ServerFiles
include ServerCommands

def hit_local_server
 package = '{"accept":"json","content_type":"json","payload":"{\"pusher\":{\"name\":\"none\"},\"repository\":{\"name\":\"churn\",\"has_wiki\":true,\"size\":180,\"created_at\":\"2009-12-13T10:55:02-08:00\",\"watchers\":85,\"private\":false,\"url\":\"https://github.com/danmayer/churn\",\"fork\":false,\"language\":\"Ruby\",\"id\":434077,\"pushed_at\":\"2012-09-24T17:22:34-07:00\",\"open_issues\":1,\"has_downloads\":true,\"has_issues\":true,\"homepage\":\"https://github.com/danmayer/churn\",\"description\":\"Providing additional churn metrics over the original metric_fu churn\",\"forks\":17,\"stargazers\":85,\"owner\":{\"name\":\"danmayer\",\"email\":\"danmayer@gmail.com\"}},\"forced\":false,\"head_commit\":{\"added\":[],\"modified\":[\"churn.gemspec\"],\"author\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"},\"removed\":[],\"timestamp\":\"2012-09-24T17:21:30-07:00\",\"url\":\"https://github.com/danmayer/churn/commit/81b6eaa479a5091d7eedfff1947512b552954fd2\",\"id\":\"81b6eaa479a5091d7eedfff1947512b552954fd2\",\"distinct\":true,\"message\":\"bump version because bundler / jeweler screwed up the dependancies again\",\"committer\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"}},\"after\":\"81b6eaa479a5091d7eedfff1947512b552954fd2\",\"deleted\":false,\"commits\":[{\"added\":[],\"modified\":[\"churn.gemspec\"],\"author\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"},\"removed\":[],\"timestamp\":\"2012-09-24T17:13:03-07:00\",\"url\":\"https://github.com/danmayer/churn/commit/7096ce9f7d0fc47cd6c4ae306c7ceef1b899fa4f\",\"id\":\"7096ce9f7d0fc47cd6c4ae306c7ceef1b899fa4f\",\"distinct\":true,\"message\":\"new gemspec for 0.0.23\",\"committer\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"}},{\"added\":[],\"modified\":[\"VERSION\"],\"author\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"},\"removed\":[],\"timestamp\":\"2012-09-24T17:17:47-07:00\",\"url\":\"https://github.com/danmayer/churn/commit/d613bc8e3ab20d79b7ec94db277de9955b2fb306\",\"id\":\"d613bc8e3ab20d79b7ec94db277de9955b2fb306\",\"distinct\":true,\"message\":\"Version bump to 0.0.24\",\"committer\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"}},{\"added\":[],\"modified\":[\"churn.gemspec\"],\"author\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"},\"removed\":[],\"timestamp\":\"2012-09-24T17:21:30-07:00\",\"url\":\"https://github.com/danmayer/churn/commit/81b6eaa479a5091d7eedfff1947512b552954fd2\",\"id\":\"81b6eaa479a5091d7eedfff1947512b552954fd2\",\"distinct\":true,\"message\":\"bump version because bundler / jeweler screwed up the dependancies again\",\"committer\":{\"name\":\"Dan Mayer\",\"username\":\"danmayer\",\"email\":\"dan@mayerdan.com\"}}],\"ref\":\"refs/heads/master\",\"before\":\"c2b1bee270118c80d9158c863ab07e3401be49ff\",\"compare\":\"https://github.com/danmayer/churn/compare/c2b1bee27011...81b6eaa479a5\",\"created\":false}"}'
  package = JSON.parse(package)
  post_to_server(:payload, package['payload'], {:server_ip => '127.0.0.1:3000', :server => nil})
end

hit_local_server
